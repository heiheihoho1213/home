1:"$Sreact.fragment"
2:I[48226,["/_next/static/chunks/13d576de3999a9ec.js"],""]
f4:I[99706,["/_next/static/chunks/b18da497cd71639c.js","/_next/static/chunks/a43937f87dbafba4.js"],"OutletBoundary"]
f5:"$Sreact.suspense"
:HL["/img/posts/2023-3-19/2023-3-19-1.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-2.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-3.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-4.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-5.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-6.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-7.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-8.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-9.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-10.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-11.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-12.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-13.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-14.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-15.png","image"]
:HL["/img/posts/2023-3-19/2023-3-19-16.png","image"]
0:{"buildId":"gG-fcHfRh54-2G67d48NM","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"max-w-4xl mx-auto","children":[["$","$L2",null,{"href":"/blog","children":["$","button",null,{"className":"\n        relative font-bold uppercase tracking-wider border-2 border-black transition-all duration-75 active:top-[4px] active:left-[4px] active:shadow-none \n        bg-white text-black hover:bg-gray-100 \n        shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]\n        py-3 px-6 \n         \n        mb-8\n      ","children":"← Back to Overview"}]}],["$","div",null,{"className":"\n      border-2 border-black \n      bg-white\n      shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]\n      \n      p-8 md:p-12 bg-white\n    ","children":[["$","div",null,{"className":"border-b-4 border-black pb-6 mb-8","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-4 mb-4 text-sm font-bold uppercase tracking-wider text-gray-500","children":[["$","span",null,{"children":"2023-03-19"}],["$","span",null,{"children":"•"}],["$","span",null,{"children":["10 min"," ","read"]}],["$","span",null,{"className":"hidden sm:inline","children":"•"}],["$","div",null,{"className":"flex gap-2","children":[["$","span","工程化",{"className":"bg-yellow-200 border border-black px-1.5 py-0.5 text-[10px] text-black","children":"工程化"}]]}]]}],["$","h1",null,{"className":"text-4xl md:text-4xl font-black uppercase leading-none","children":"写一个简易的前端灰度系统"}]]}],["$","div",null,{"className":"prose prose-xl prose-black max-w-none font-medium markdown-content","children":[["$","h2","h2-0",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"1. 写在前面的话"}],"\n",["$","p","p-0",{"className":"mb-4 text-lg leading-relaxed","children":["灰度这个概念，来自数字图像领域，最初是描述黑白数字图像的灰度值，范围从 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"0","position":{"start":{"line":3,"column":37,"offset":50},"end":{"line":3,"column":40,"offset":53}}}],"position":{"start":{"line":3,"column":37,"offset":50},"end":{"line":3,"column":40,"offset":53}}},"children":"0"}]," 到 ",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"255","position":{"start":{"line":3,"column":43,"offset":56},"end":{"line":3,"column":48,"offset":61}}}],"position":{"start":{"line":3,"column":43,"offset":56},"end":{"line":3,"column":48,"offset":61}}},"children":"255"}],"，",["$","code","code-2",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"0","position":{"start":{"line":3,"column":49,"offset":62},"end":{"line":3,"column":52,"offset":65}}}],"position":{"start":{"line":3,"column":49,"offset":62},"end":{"line":3,"column":52,"offset":65}}},"children":"0"}]," 表示黑色，",["$","code","code-3",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"255","position":{"start":{"line":3,"column":58,"offset":71},"end":{"line":3,"column":63,"offset":76}}}],"position":{"start":{"line":3,"column":58,"offset":71},"end":{"line":3,"column":63,"offset":76}}},"children":"255"}]," 表示白色，中间的数值表示不同程度的灰色。"]}],"\n",["$","p","p-1",{"className":"mb-4 text-lg leading-relaxed","children":["灰度系统的诞生源于交叉学科的建设，在互联网上也不例外。对于一个软件产品，在开发和发布的时候肯定希望用户能够顺利的看到想让其看到的内容。但是，发布没有一帆风顺的，如果在发布的某个环节出了问题，比如打错了镜像或者由于部署环境不同触发了隐藏的bug，导致用户看到了错误的页面或者旧的页面，这就出现了生产事故。为了避免这种情况出现，借鉴数字图像处理的理念，设计师们设计出了一种介于 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"0","position":{"start":{"line":5,"column":188,"offset":286},"end":{"line":5,"column":191,"offset":289}}}],"position":{"start":{"line":5,"column":188,"offset":286},"end":{"line":5,"column":191,"offset":289}}},"children":"0"}]," 和 ",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"1","position":{"start":{"line":5,"column":194,"offset":292},"end":{"line":5,"column":197,"offset":295}}}],"position":{"start":{"line":5,"column":194,"offset":292},"end":{"line":5,"column":197,"offset":295}}},"children":"1"}]," 之间的","$L3","的概念：让系统可以预先发布，并设置可见范围，就像朋友圈一样，等到风险可控后，再对公众可见。这就是灰度系统。"]}],"\n","$L4","\n","$L5","\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b","\n","$L4c","\n","$L4d","\n","$L4e","\n","$L4f","\n","$L50","\n","$L51","\n","$L52","\n","$L53","\n","$L54","\n","$L55","\n","$L56","\n","$L57"]}]]}]]}],null,"$L58"]}],"loading":null,"isPartial":false}
3:["$","code","code-2",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"过渡系统","position":{"start":{"line":5,"column":201,"offset":299},"end":{"line":5,"column":207,"offset":305}}}],"position":{"start":{"line":5,"column":201,"offset":299},"end":{"line":5,"column":207,"offset":305}}},"children":"过渡系统"}]
4:["$","p","p-2",{"className":"mb-4 text-lg leading-relaxed","children":["灰度系统版本的发布动作称作 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"灰度发布","position":{"start":{"line":7,"column":15,"offset":374},"end":{"line":7,"column":21,"offset":380}}}],"position":{"start":{"line":7,"column":15,"offset":374},"end":{"line":7,"column":21,"offset":380}}},"children":"灰度发布"}],"，又名金丝雀发布，或者灰度测试，他是指在黑与白之间能够平滑过渡的一种发布方式。在其上可以进行A/B testing，即让一部分用户继续用产品特性A，一部分用户开始用产品特性B，如果用户对B没有什么反对意见，那么逐步扩大范围，把所有用户都迁移到B上面来。(概念来自知乎)"]}]
5:["$","p","p-3",{"className":"mb-4 text-lg leading-relaxed","children":"对于前端领域，演进到现在，灰度系统主要有如下几点功能："}]
6:["$","ol","ol-0",{"className":"ml-4 list-decimal mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"增量灰度：小的patch可以增量的添加在发布版本上，也可以通过开关一键关闭"}],"\n",["$","li","li-1",{"className":"font-bold mb-2","children":"用户灰度：增量和全量版本都可对不同群体或者某几个特定的用户进行灰度可见"}],"\n",["$","li","li-2",{"className":"font-bold mb-2","children":"版本回退：每一个版本都在灰度系统里可见，可以一键回退"}],"\n"]}]
7:["$","p","p-4",{"className":"mb-4 text-lg leading-relaxed","children":"前端灰度系统工作流程图如下："}]
8:["$","div","pre-0,code-0",{"className":"my-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","div",null,{"node":{"type":"element","tagName":"code","properties":{"className":["language-mermaid"]},"children":[{"type":"text","value":"sequenceDiagram\n前端项目-->灰度系统: 部署阶段\n前端项目->>灰度系统: 1.CI 打包后写入打包资源，状态初始化\n前端项目-->灰度系统: 访问阶段\n前端项目->>灰度系统: 1.页面访问，请求当前登录用户对应的资源版本\n灰度系统-->>前端项目: 2.从对应版本的资源目录返回前端资源\n"}],"position":{"start":{"line":18,"column":1,"offset":673},"end":{"line":25,"column":4,"offset":842}}},"style":{"background":"#ffffff","color":"hsl(230, 8%, 24%)","fontFamily":"\"Fira Code\", \"Fira Mono\", Menlo, Consolas, \"DejaVu Sans Mono\", monospace","direction":"ltr","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","lineHeight":"1.5","MozTabSize":"2","OTabSize":"2","tabSize":"2","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1.5rem","margin":0,"overflow":"auto","borderRadius":0,"fontSize":"0.875rem"},"children":["$","code",null,{"style":{"whiteSpace":"pre","fontFamily":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace"},"children":[false,[["$","span","line-number--1",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[1]}],["$","span","code-segment-1",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["sequenceDiagram"]}],["$","span","code-segment-2",{"style":{},"children":["\n"]}],["$","span","line-number--2",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[2]}],["$","span","code-segment-4",{"style":{},"children":["前端项目"]}],["$","span","code-segment-5",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-6",{"style":{},"children":["灰度系统"]}],["$","span","code-segment-7",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],["$","span","code-segment-8",{"style":{},"children":[" 部署阶段\n"]}],["$","span","line-number--3",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[3]}],["$","span","code-segment-10",{"style":{},"children":["前端项目"]}],["$","span","code-segment-11",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["->>"]}],["$","span","code-segment-12",{"style":{},"children":["灰度系统"]}],["$","span","code-segment-13",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],["$","span","code-segment-14",{"style":{},"children":[" 1.CI 打包后写入打包资源，状态初始化\n"]}],["$","span","line-number--4",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[4]}],["$","span","code-segment-16",{"style":{},"children":["前端项目"]}],["$","span","code-segment-17",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-18",{"style":{},"children":["灰度系统"]}],["$","span","code-segment-19",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],["$","span","code-segment-20",{"style":{},"children":[" 访问阶段\n"]}],["$","span","line-number--5",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[5]}],["$","span","code-segment-22",{"style":{},"children":["前端项目"]}],["$","span","code-segment-23",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["->>"]}],["$","span","code-segment-24",{"style":{},"children":["灰度系统"]}],["$","span","code-segment-25",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],"$L59","$L5a","$L5b","$L5c","$L5d","$L5e","$L5f"]]}]}]}]
9:["$","h2","h2-1",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-1.png","alt":"","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-1.png","alt":""},"children":[],"position":{"start":{"line":27,"column":1,"offset":844},"end":{"line":27,"column":42,"offset":885}}}}]}]
a:["$","h2","h2-2",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"2. 灰度规则"}]
b:["$","p","p-5",{"className":"mb-4 text-lg leading-relaxed","children":"关于灰度资源优先级的说明如下："}]
c:["$","div","table-0",{"className":"my-6 overflow-x-auto border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","table",null,{"className":"w-full border-collapse text-left","children":[["$","thead","thead-0",{"className":"bg-yellow-200 border-b-2 border-black uppercase tracking-wider text-sm","children":["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","th","th-0",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"灰度策略"}],["$","th","th-1",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"优先级"}]]}]}],["$","tbody","tbody-0",{"className":"[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-neutral-50","children":[["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"未生效"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"低"}]]}],["$","tr","tr-1",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"生效"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"高"}]]}],["$","tr","tr-2",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"全量"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"一般"}]]}]]}]]}]}]
d:["$","p","p-6",{"className":"mb-4 text-lg leading-relaxed","children":["如此就起到了",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"灰度","position":{"start":{"line":40,"column":7,"offset":991},"end":{"line":40,"column":11,"offset":995}}}],"position":{"start":{"line":40,"column":7,"offset":991},"end":{"line":40,"column":11,"offset":995}}},"children":"灰度"}],"的作用：全量表示所有人都可以看；生效表示只有在规则中的用户才可以看到这部分增量更新，优先级最高；未生效表示不灰度，优先级最低。"]}]
e:["$","h2","h2-3",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"3. 灰度系统数据库设计"}]
f:["$","blockquote","blockquote-0",{"className":"bg-gray-100 p-4 border-l-4 border-black italic my-4","children":["\n",["$","p","p-0",{"className":"mb-4 text-lg leading-relaxed","children":[["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"为什么灰度系统有后端","position":{"start":{"line":44,"column":3,"offset":1079},"end":{"line":44,"column":15,"offset":1091}}}],"position":{"start":{"line":44,"column":3,"offset":1079},"end":{"line":44,"column":15,"offset":1091}}},"children":"为什么灰度系统有后端"}],"：前端项目 CI 部署后，会产生一个 commit 号和一个镜像记录，并且打包后的文件存放在服务器中某一个深层的文件夹目录中，灰度系统需要存入该部署的目录地址，便于在切换灰度时查找不同版本的文件。"]}],"\n"]}]
10:["$","p","p-7",{"className":"mb-4 text-lg leading-relaxed","children":"先介绍一个要部署的前端项目（你可以根据自己的前端项目动态调整）。"}]
11:["$","p","p-8",{"className":"mb-4 text-lg leading-relaxed","children":"本项目针对的前端项目是一个基于微服务架构的项目，"}]
12:["$","p","p-9",{"className":"mb-4 text-lg leading-relaxed","children":"下面是设计ER图："}]
13:["$","p","p-10",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-2.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-2.png","alt":"image.png"},"children":[],"position":{"start":{"line":54,"column":1,"offset":1264},"end":{"line":54,"column":51,"offset":1314}}}}]}]
14:["$","p","p-11",{"className":"mb-4 text-lg leading-relaxed","children":"我们依此来分析："}]
15:["$","h3","h3-0",{"className":"text-xl font-bold mt-4 mb-2","children":"子项目表"}]
16:["$","p","p-12",{"className":"mb-4 text-lg leading-relaxed","children":"该表用于存放所有子项目的信息，新建一个微服务子项目时，会在这个表里新建一个条目，数据示意如下："}]
17:["$","p","p-13",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-3.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-3.png","alt":"image.png"},"children":[],"position":{"start":{"line":63,"column":1,"offset":1386},"end":{"line":63,"column":51,"offset":1436}}}}]}]
18:["$","h3","h3-1",{"className":"text-xl font-bold mt-4 mb-2","children":"灰度用户表"}]
19:["$","p","p-14",{"className":"mb-4 text-lg leading-relaxed","children":"用于灰度系统登录的用户，拥有灰度权限的人才可以加入。"}]
1a:["$","h3","h3-2",{"className":"text-xl font-bold mt-4 mb-2","children":"资源表"}]
1b:["$","p","p-15",{"className":"mb-4 text-lg leading-relaxed","children":"资源表存放项目在 CI 中写入的 commit 信息和 build 完以后在服务器的存放位置，数据示意如下："}]
1c:["$","p","p-16",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-4.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-4.png","alt":"image.png"},"children":[],"position":{"start":{"line":74,"column":1,"offset":1543},"end":{"line":74,"column":51,"offset":1593}}}}]}]
1d:["$","p","p-17",{"className":"mb-4 text-lg leading-relaxed","children":["其中 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"branch","position":{"start":{"line":76,"column":4,"offset":1598},"end":{"line":76,"column":12,"offset":1606}}}],"position":{"start":{"line":76,"column":4,"offset":1598},"end":{"line":76,"column":12,"offset":1606}}},"children":"branch"}]," 是跑CI的分支，",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"data","position":{"start":{"line":76,"column":21,"offset":1615},"end":{"line":76,"column":27,"offset":1621}}}],"position":{"start":{"line":76,"column":21,"offset":1615},"end":{"line":76,"column":27,"offset":1621}}},"children":"data"}]," 存放打包资源目录信息，一般结构如下："]}]
1e:["$","p","p-18",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-5.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-5.png","alt":"image.png"},"children":[],"position":{"start":{"line":79,"column":1,"offset":1643},"end":{"line":79,"column":51,"offset":1693}}}}]}]
1f:["$","p","p-19",{"className":"mb-4 text-lg leading-relaxed","children":[["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"gitProjectId","position":{"start":{"line":81,"column":1,"offset":1695},"end":{"line":81,"column":15,"offset":1709}}}],"position":{"start":{"line":81,"column":1,"offset":1695},"end":{"line":81,"column":15,"offset":1709}}},"children":"gitProjectId"}]," 存放该产品在 gitlab 中的项目号， ",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"status","position":{"start":{"line":81,"column":37,"offset":1731},"end":{"line":81,"column":45,"offset":1739}}}],"position":{"start":{"line":81,"column":37,"offset":1731},"end":{"line":81,"column":45,"offset":1739}}},"children":"status"}]," 表示构建状态：0：构建完成 1：部署完成 2：构建失败，3：部署失败。"]}]
20:["$","p","p-20",{"className":"mb-4 text-lg leading-relaxed","children":"这里简单提一下 CI 是如何写入灰度系统数据库的，过多详情不做解释，写入数据库方式很多，这只是其中一种实现方式。"}]
21:["$","ol","ol-1",{"className":"ml-4 list-decimal mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"首先在 CI build 环节往服务器写入打包信息的 JSON："}],"\n"]}]
22:["$","p","p-21",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-6.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-6.png","alt":"image.png"},"children":[],"position":{"start":{"line":87,"column":1,"offset":1872},"end":{"line":87,"column":51,"offset":1922}}}}]}]
23:["$","p","p-22",{"className":"mb-4 text-lg leading-relaxed","children":"其中 build.sh 负责把传入的参数写到一个 json 中。上图中是往根目录copy，方便下一个 CI job读取json文件的示意图。"}]
24:["$","ol","ol-2",{"className":"ml-4 list-decimal mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"在 CI 部署环节，通过调用脚本创建资源："}],"\n"]}]
25:["$","p","p-23",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-7.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-7.png","alt":"image.png"},"children":[],"position":{"start":{"line":94,"column":1,"offset":2023},"end":{"line":94,"column":51,"offset":2073}}}}]}]
26:["$","p","p-24",{"className":"mb-4 text-lg leading-relaxed","children":"其中 run_gray.js:"}]
27:["$","div","pre-1,code-0",{"className":"my-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","div",null,{"node":{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"const { ENV, file, branch, projectId, gitProjectId, user, commitMsg } = require('yargs').argv;\n\naxios({\n    url: URL,\n    method: \"POST\",\n    headers: {\n        remoteUser: user\n    },\n    data: {\n        Action: \"CreateResource\",\n        projectId,\n        branch,\n        commitMsg,\n        gitProjectId,\n        channel: Channel,\n        data: fs.readFileSync(file, 'utf8'),\n        status: \"0\"\n    }\n}).then(...)\n"}],"position":{"start":{"line":98,"column":1,"offset":2092},"end":{"line":118,"column":4,"offset":2518}}},"style":{"background":"#ffffff","color":"hsl(230, 8%, 24%)","fontFamily":"\"Fira Code\", \"Fira Mono\", Menlo, Consolas, \"DejaVu Sans Mono\", monospace","direction":"ltr","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","lineHeight":"1.5","MozTabSize":"2","OTabSize":"2","tabSize":"2","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1.5rem","margin":0,"overflow":"auto","borderRadius":0,"fontSize":"0.875rem"},"children":["$","code",null,{"style":{"whiteSpace":"pre","fontFamily":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace"},"children":[false,[["$","span","line-number--1",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[1]}],["$","span","code-segment-1",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["const"]}],["$","span","code-segment-2",{"style":{},"children":[" "]}],["$","span","code-segment-3",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}],["$","span","code-segment-4",{"style":{},"children":[" "]}],["$","span","code-segment-5",{"className":"token","style":{"color":"hsl(35, 99%, 36%)"},"children":["ENV"]}],["$","span","code-segment-6",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-7",{"style":{},"children":[" file"]}],["$","span","code-segment-8",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-9",{"style":{},"children":[" branch"]}],["$","span","code-segment-10",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-11",{"style":{},"children":[" projectId"]}],["$","span","code-segment-12",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-13",{"style":{},"children":[" gitProjectId"]}],["$","span","code-segment-14",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-15",{"style":{},"children":[" user"]}],["$","span","code-segment-16",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}],["$","span","code-segment-17",{"style":{},"children":[" commitMsg "]}],["$","span","code-segment-18",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}],["$","span","code-segment-19",{"style":{},"children":[" "]}],["$","span","code-segment-20",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":["="]}],["$","span","code-segment-21",{"style":{},"children":[" "]}],["$","span","code-segment-22",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":["require"]}],["$","span","code-segment-23",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["("]}],["$","span","code-segment-24",{"className":"token","style":{"color":"hsl(119, 34%, 47%)"},"children":["'yargs'"]}],["$","span","code-segment-25",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[")"]}],["$","span","code-segment-26",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["."]}],["$","span","code-segment-27",{"className":"token property-access","style":{},"children":["argv"]}],["$","span","code-segment-28",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[";"]}],["$","span","code-segment-29",{"style":{},"children":["\n"]}],"$L60","\n","$L61","$L62","$L63","$L64","$L65","$L66","$L67","$L68","$L69","$L6a","$L6b","$L6c","$L6d","$L6e","$L6f","$L70","$L71","$L72","$L73","$L74","$L75","$L76","$L77","$L78","$L79","$L7a","$L7b","$L7c","$L7d","$L7e","$L7f","$L80","$L81","$L82","$L83","$L84","$L85","$L86","$L87","$L88","$L89","$L8a","$L8b","$L8c","$L8d","$L8e","$L8f","$L90","$L91","$L92","$L93","$L94","$L95","$L96","$L97","$L98","$L99","$L9a","$L9b","$L9c","$L9d","$L9e","$L9f","$La0","$La1","$La2","$La3","$La4","$La5","$La6","$La7","$La8","$La9","$Laa","$Lab","$Lac","$Lad","$Lae","$Laf","$Lb0","$Lb1","$Lb2","$Lb3","$Lb4","$Lb5","$Lb6","$Lb7","$Lb8","$Lb9","$Lba","$Lbb","$Lbc","$Lbd","$Lbe","$Lbf","$Lc0","$Lc1","$Lc2","$Lc3","$Lc4","$Lc5","$Lc6","$Lc7","$Lc8","$Lc9","$Lca","$Lcb","$Lcc","$Lcd","$Lce","$Lcf","$Ld0","$Ld1"]]}]}]}]
28:["$","p","p-25",{"className":"mb-4 text-lg leading-relaxed","children":["其中 status 的变化，在 CI 部署服务器完成后，追加一个 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"UpdateResource","position":{"start":{"line":119,"column":34,"offset":2552},"end":{"line":119,"column":50,"offset":2568}}}],"position":{"start":{"line":119,"column":34,"offset":2552},"end":{"line":119,"column":50,"offset":2568}}},"children":"UpdateResource"}]," 动作即可："]}]
29:["$","code","pre-2,code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"if [[ $RetCode != 0 ]]; then curl \"$STARK_URL\" -X 'POST' -H 'remoteUser: '\"$GITLAB_USER_NAME\"'' -H 'Content-Type: application/json' -d '{\"Action\": \"UpdateResource\", \"id\": \"'\"$ResourceId\"'\", \"status\": \"2\"}' > test.log && echo `cat test.log`; fi\n"}],"position":{"start":{"line":121,"column":1,"offset":2576},"end":{"line":123,"column":4,"offset":2827}}},"children":"if [[ $RetCode != 0 ]]; then curl \"$STARK_URL\" -X 'POST' -H 'remoteUser: '\"$GITLAB_USER_NAME\"'' -H 'Content-Type: application/json' -d '{\"Action\": \"UpdateResource\", \"id\": \"'\"$ResourceId\"'\", \"status\": \"2\"}' > test.log && echo `cat test.log`; fi\n"}]
2a:["$","h3","h3-3",{"className":"text-xl font-bold mt-4 mb-2","children":"灰度策略表"}]
2b:["$","p","p-26",{"className":"mb-4 text-lg leading-relaxed","children":"灰度策略是对灰度资源的调动配置。其设计如下："}]
2c:["$","p","p-27",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-8.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-8.png","alt":"image.png"},"children":[],"position":{"start":{"line":129,"column":1,"offset":2864},"end":{"line":129,"column":51,"offset":2914}}}}]}]
2d:["$","p","p-28",{"className":"mb-4 text-lg leading-relaxed","children":["其中，",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"prijectId","position":{"start":{"line":131,"column":4,"offset":2919},"end":{"line":131,"column":15,"offset":2930}}}],"position":{"start":{"line":131,"column":4,"offset":2919},"end":{"line":131,"column":15,"offset":2930}}},"children":"prijectId"}]," 表示灰度的项目，",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"resourceId","position":{"start":{"line":131,"column":24,"offset":2939},"end":{"line":131,"column":36,"offset":2951}}}],"position":{"start":{"line":131,"column":24,"offset":2939},"end":{"line":131,"column":36,"offset":2951}}},"children":"resourceId"}]," 表示使用的资源，",["$","code","code-2",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"rules","position":{"start":{"line":131,"column":45,"offset":2960},"end":{"line":131,"column":52,"offset":2967}}}],"position":{"start":{"line":131,"column":45,"offset":2960},"end":{"line":131,"column":52,"offset":2967}}},"children":"rules"}]," 配置了对应的用户或用户组（看你怎么配置了，我这里只配置了单独的 userId），",["$","code","code-3",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"status","position":{"start":{"line":131,"column":93,"offset":3008},"end":{"line":131,"column":101,"offset":3016}}}],"position":{"start":{"line":131,"column":93,"offset":3008},"end":{"line":131,"column":101,"offset":3016}}},"children":"status"}]," 是灰度的状态，我设置了三种："]}]
2e:["$","ul","ul-0",{"className":"ml-4 list-disc mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"default: 未生效"}],"\n",["$","li","li-1",{"className":"font-bold mb-2","children":"failure: 生效"}],"\n",["$","li","li-2",{"className":"font-bold mb-2","children":"success: 全量"}],"\n"]}]
2f:["$","p","p-29",{"className":"mb-4 text-lg leading-relaxed","children":"状态生效表示是增量发布的意思。"}]
30:["$","p","p-30",{"className":"mb-4 text-lg leading-relaxed","children":"到这里，数据库设计就完毕了。"}]
31:["$","hr","hr-0",{}]
32:["$","h2","h2-4",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"4. 灰度系统接口API开发"}]
33:["$","p","p-31",{"className":"mb-4 text-lg leading-relaxed","children":"有了数据库，还需要提供能够操作数据库的服务，上边创建资源的接口就是调用的灰度自己的API实现的。主要的API列表如下："}]
34:["$","div","table-1",{"className":"my-6 overflow-x-auto border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","table",null,{"className":"w-full border-collapse text-left","children":[["$","thead","thead-0",{"className":"bg-yellow-200 border-b-2 border-black uppercase tracking-wider text-sm","children":["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","th","th-0",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"名称"}],["$","th","th-1",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"描述"}]]}]}],["$","tbody","tbody-0",{"className":"[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-neutral-50","children":[["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"getResourcesByProjectId"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"获取单个产品下所有资源"}]]}],["$","tr","tr-1",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"getResourcesById"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"通过主键获取资源"}]]}],["$","tr","tr-2",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"createResource"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"创建一个资源"}]]}],["$","tr","tr-3",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"updateResource"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"更新一个资源"}]]}],["$","tr","tr-4",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"getIngressesByProjectId"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"获取单个产品下灰度策略任务列表"}]]}],["$","tr","tr-5",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"getIngressById"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"通过主键获取单个灰度策略任务详情"}]]}],["$","tr","tr-6",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"createIngress"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"创建一个策略"}]]}],["$","tr","tr-7",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"updateIngress"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"更新一个策略"}]]}]]}]]}]}]
35:["$","p","p-32",{"className":"mb-4 text-lg leading-relaxed","children":"剩余的接口有用户处理的，有子项目管理的，这里不做详述。除了上边的必须的接口外，还有一个最重要的接口，那就是获取当前登录用户需要的资源版本的接口。在用户访问时，需要首先调用灰度系统的这个接口来获取资源地址，然后才能重定向到给该用户看的页面中去："}]
36:["$","div","table-2",{"className":"my-6 overflow-x-auto border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","table",null,{"className":"w-full border-collapse text-left","children":[["$","thead","thead-0",{"className":"bg-yellow-200 border-b-2 border-black uppercase tracking-wider text-sm","children":["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","th","th-0",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"名称"}],["$","th","th-1",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"描述"}],["$","th","th-2",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"接收参数"}],["$","th","th-3",{"className":"px-4 py-3 text-base font-black border-r border-black last:border-r-0","children":"输出"}]]}]}],["$","tbody","tbody-0",{"className":"[&>tr:nth-child(odd)]:bg-white [&>tr:nth-child(even)]:bg-neutral-50","children":["$","tr","tr-0",{"className":"border-b border-black last:border-b-0","children":[["$","td","td-0",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"getConsoleVersion"}],["$","td","td-1",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"获取当前用的产品版本"}],["$","td","td-2",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"userId，products"}],["$","td","td-3",{"className":"px-4 py-3 text-sm font-semibold border-r border-black last:border-r-0","children":"resource键值对列表"}]]}]}]]}]}]
37:["$","p","p-33",{"className":"mb-4 text-lg leading-relaxed","children":[["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"getConsoleVersion","position":{"start":{"line":165,"column":1,"offset":3734},"end":{"line":165,"column":20,"offset":3753}}}],"position":{"start":{"line":165,"column":1,"offset":3734},"end":{"line":165,"column":20,"offset":3753}}},"children":"getConsoleVersion"}]," 接受两个参数，一个是当前登录的用户 ID， 一个是当前用户访问的微服务系统中所包含的产品列表。该接口做了如下几步操作："]}]
38:["$","ol","ol-3",{"className":"ml-4 list-decimal mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"遍历 products，获取每一个产品的 projectId"}],"\n",["$","li","li-1",{"className":"font-bold mb-2","children":"对于每一个 projectId，联查资源表，分别获取对应的 resourceId"}],"\n",["$","li","li-2",{"className":"font-bold mb-2","children":"对于每一个resourceId，结合 userId，并联查灰度策略表，筛选出起作用的灰度策略中可用的资源"}],"\n",["$","li","li-3",{"className":"font-bold mb-2","children":"返回每一个资源的 data 信息。"}],"\n"]}]
39:["$","p","p-34",{"className":"mb-4 text-lg leading-relaxed","children":"其中第三步处理相对繁琐一些，比如说，一个资源有两个起作用的灰度资源，一个是增量的，一个是全量的，这里应该拿增量的版本，因为他优先级更高。"}]
3a:["$","p","p-35",{"className":"mb-4 text-lg leading-relaxed","children":"获取用户版本的流程图如下："}]
3b:["$","div","pre-3,code-0",{"className":"my-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","div",null,{"node":{"type":"element","tagName":"code","properties":{"className":["language-mermaid"]},"children":[{"type":"text","value":"graph TD\n用户登录页面 --> 获取所有产品下的资源列表\n获取所有产品下的资源列表 --> 根据灰度策略筛选资源中该用户可用的部分 --> 返回产品维度的资源对象\n"}],"position":{"start":{"line":178,"column":1,"offset":4058},"end":{"line":182,"column":4,"offset":4158}}},"style":{"background":"#ffffff","color":"hsl(230, 8%, 24%)","fontFamily":"\"Fira Code\", \"Fira Mono\", Menlo, Consolas, \"DejaVu Sans Mono\", monospace","direction":"ltr","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","lineHeight":"1.5","MozTabSize":"2","OTabSize":"2","tabSize":"2","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1.5rem","margin":0,"overflow":"auto","borderRadius":0,"fontSize":"0.875rem"},"children":["$","code",null,{"style":{"whiteSpace":"pre","fontFamily":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace"},"children":[false,[["$","span","line-number--1",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[1]}],["$","span","code-segment-1",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["graph"]}],["$","span","code-segment-2",{"style":{},"children":[" TD\n"]}],["$","span","line-number--2",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[2]}],["$","span","code-segment-4",{"style":{},"children":["用户登录页面 "]}],["$","span","code-segment-5",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-6",{"style":{},"children":[" 获取所有产品下的资源列表\n"]}],["$","span","line-number--3",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[3]}],["$","span","code-segment-8",{"style":{},"children":["获取所有产品下的资源列表 "]}],["$","span","code-segment-9",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-10",{"style":{},"children":[" 根据灰度策略筛选资源中该用户可用的部分 "]}],["$","span","code-segment-11",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-12",{"style":{},"children":[" 返回产品维度的资源对象"]}]]]}]}]}]
3c:["$","p","p-36",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-9.png","alt":"","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-9.png","alt":""},"children":[],"position":{"start":{"line":184,"column":1,"offset":4160},"end":{"line":184,"column":42,"offset":4201}}}}]}]
3d:["$","p","p-37",{"className":"mb-4 text-lg leading-relaxed","children":"最后返回的资源大概长这个样子："}]
3e:["$","div","pre-4,code-0",{"className":"my-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","div",null,{"node":{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"interface VersionResponse {\n    [productId: number]: ResourceVersion;\n}\n\ninterface ResourceVersion {\n    files: string[];\n    config: ResourceConfig;\n    dependencies: string[];\n}\n"}],"position":{"start":{"line":188,"column":1,"offset":4220},"end":{"line":198,"column":4,"offset":4409}}},"style":{"background":"#ffffff","color":"hsl(230, 8%, 24%)","fontFamily":"\"Fira Code\", \"Fira Mono\", Menlo, Consolas, \"DejaVu Sans Mono\", monospace","direction":"ltr","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","lineHeight":"1.5","MozTabSize":"2","OTabSize":"2","tabSize":"2","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1.5rem","margin":0,"overflow":"auto","borderRadius":0,"fontSize":"0.875rem"},"children":["$","code",null,{"style":{"whiteSpace":"pre","fontFamily":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace"},"children":[false,[["$","span","line-number--1",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[1]}],["$","span","code-segment-1",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["interface"]}],["$","span","code-segment-2",{"style":{},"children":[" "]}],["$","span","code-segment-3",{"className":"token","style":{"color":"hsl(35, 99%, 36%)"},"children":["VersionResponse"]}],["$","span","code-segment-4",{"style":{},"children":[" "]}],["$","span","code-segment-5",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}],["$","span","code-segment-6",{"style":{},"children":["\n"]}],["$","span","line-number--2",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[2]}],["$","span","code-segment-8",{"style":{},"children":["    "]}],["$","span","code-segment-9",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["["]}],["$","span","code-segment-10",{"style":{},"children":["productId"]}],["$","span","code-segment-11",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],["$","span","code-segment-12",{"style":{},"children":[" number"]}],["$","span","code-segment-13",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["]"]}],["$","span","code-segment-14",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}],["$","span","code-segment-15",{"style":{},"children":[" "]}],["$","span","code-segment-16",{"className":"token maybe-class-name","style":{},"children":["ResourceVersion"]}],["$","span","code-segment-17",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[";"]}],["$","span","code-segment-18",{"style":{},"children":["\n"]}],["$","span","line-number--3",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[3]}],["$","span","code-segment-20",{"style":{},"children":[""]}],["$","span","code-segment-21",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}],["$","span","code-segment-22",{"style":{},"children":["\n"]}],["$","span","line-number--4",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[4]}],"\n",["$","span","line-number--5",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[5]}],["$","span","code-segment-26",{"style":{},"children":[""]}],["$","span","code-segment-27",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["interface"]}],"$Ld2","$Ld3","$Ld4","$Ld5","$Ld6","$Ld7","$Ld8","$Ld9","$Lda","$Ldb","$Ldc","$Ldd","$Lde","$Ldf","$Le0","$Le1","$Le2","$Le3","$Le4","$Le5","$Le6","$Le7","$Le8","$Le9","$Lea","$Leb","$Lec","$Led","$Lee","$Lef","$Lf0","$Lf1","$Lf2","$Lf3"]]}]}]}]
3f:["$","p","p-38",{"className":"mb-4 text-lg leading-relaxed","children":"其中 files 就是 JSON 解析后的上述 data 信息的文件列表，因为打包后的文件往往有 css和多个js。"}]
40:["$","p","p-39",{"className":"mb-4 text-lg leading-relaxed","children":"至于这个后端使用什么语言，什么框架来写，并不重要，重要的是一定要稳定，他要挂掉了，用户就进不去系统了，容灾和容错要做好；如果是个客户比较多的网站，并发分流也要考虑进去。"}]
41:["$","h2","h2-5",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"5. 前端页面展示"}]
42:["$","p","p-40",{"className":"mb-4 text-lg leading-relaxed","children":"前端页面就随便使用了一个前端框架搭了一下，选型不是重点，组件库能够满足要求就行："}]
43:["$","ul","ul-1",{"className":"ml-4 list-disc mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"登录"}],"\n"]}]
44:["$","p","p-41",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-10.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-10.png","alt":"image.png"},"children":[],"position":{"start":{"line":210,"column":1,"offset":4619},"end":{"line":210,"column":52,"offset":4670}}}}]}]
45:["$","ul","ul-2",{"className":"ml-4 list-disc mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"查看资源"}],"\n"]}]
46:["$","p","p-42",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-11.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-11.png","alt":"image.png"},"children":[],"position":{"start":{"line":215,"column":1,"offset":4681},"end":{"line":215,"column":52,"offset":4732}}}}]}]
47:["$","ul","ul-3",{"className":"ml-4 list-disc mb-4","children":["\n",["$","li","li-0",{"className":"font-bold mb-2","children":"配置策略"}],"\n"]}]
48:["$","p","p-43",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-12.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-12.png","alt":"image.png"},"children":[],"position":{"start":{"line":220,"column":1,"offset":4743},"end":{"line":220,"column":52,"offset":4794}}}}]}]
49:["$","p","p-44",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-13.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-13.png","alt":"image.png"},"children":[],"position":{"start":{"line":223,"column":1,"offset":4797},"end":{"line":223,"column":52,"offset":4848}}}}]}]
4a:["$","hr","hr-1",{}]
4b:["$","p","p-45",{"className":"mb-4 text-lg leading-relaxed","children":"部署以后，实际运行项目看看效果："}]
4c:["$","p","p-46",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-14.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-14.png","alt":"image.png"},"children":[],"position":{"start":{"line":230,"column":1,"offset":4874},"end":{"line":230,"column":52,"offset":4925}}}}]}]
4d:["$","p","p-47",{"className":"mb-4 text-lg leading-relaxed","children":"可以看到，在调用业务接口之前，优先调用了 getConsoleVersion来获取版本，其返回值是以产品为 key 的键值对："}]
4e:["$","p","p-48",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-15.png","alt":"image.png","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-15.png","alt":"image.png"},"children":[],"position":{"start":{"line":235,"column":1,"offset":4993},"end":{"line":235,"column":52,"offset":5044}}}}]}]
4f:["$","h2","h2-6",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"6. 访问转发"}]
50:["$","p","p-49",{"className":"mb-4 text-lg leading-relaxed","children":["这里拿到部署信息后，服务器要进行下一步处理的。我这里是把它封装到一个对象中，带着参数传给了微服务的 hook 去了（微服务系统需要）；",["$","strong","strong-0",{"className":"font-black","children":"如果你是单页应用，可能需要把工作重心放在 Nginx 的转发上，Nginx内部服务读取灰度系统数据库来拿到版本目录，然后切换路由转发（可能只是改变一个路由变量）。"}]," （你也可以参照我 ",["$","a","a-0",{"href":"https://juejin.cn/post/7211702508371656759","className":"text-blue-600 hover:underline font-bold whitespace-wrap break-words","target":"_blank","rel":"noopener noreferrer","children":"nginx 相关文章"}],"），下面我简单的给个示意图："]}]
51:["$","div","pre-5,code-0",{"className":"my-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] bg-white","children":["$","div",null,{"node":{"type":"element","tagName":"code","properties":{"className":["language-mermaid"]},"children":[{"type":"text","value":"graph TD\n灰度系统配置灰度策略 --> Nginx+Lua+Mysql获取灰度策略并写入Nginx变量\nNginx+Lua+Mysql获取灰度策略并写入Nginx变量 --> Nginx服务器配置资源转发\n"}],"position":{"start":{"line":242,"column":1,"offset":5293},"end":{"line":246,"column":4,"offset":5414}}},"style":{"background":"#ffffff","color":"hsl(230, 8%, 24%)","fontFamily":"\"Fira Code\", \"Fira Mono\", Menlo, Consolas, \"DejaVu Sans Mono\", monospace","direction":"ltr","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","lineHeight":"1.5","MozTabSize":"2","OTabSize":"2","tabSize":"2","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1.5rem","margin":0,"overflow":"auto","borderRadius":0,"fontSize":"0.875rem"},"children":["$","code",null,{"style":{"whiteSpace":"pre","fontFamily":"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace"},"children":[false,[["$","span","line-number--1",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[1]}],["$","span","code-segment-1",{"className":"token","style":{"color":"hsl(301, 63%, 40%)"},"children":["graph"]}],["$","span","code-segment-2",{"style":{},"children":[" TD\n"]}],["$","span","line-number--2",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[2]}],["$","span","code-segment-4",{"style":{},"children":["灰度系统配置灰度策略 "]}],["$","span","code-segment-5",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-6",{"style":{},"children":[" Nginx+Lua+Mysql获取灰度策略并写入Nginx变量\n"]}],["$","span","line-number--3",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[3]}],["$","span","code-segment-8",{"style":{},"children":["Nginx+Lua+Mysql获取灰度策略并写入Nginx变量 "]}],["$","span","code-segment-9",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->"]}],["$","span","code-segment-10",{"style":{},"children":[" Nginx服务器配置资源转发"]}]]]}]}]}]
52:["$","p","p-50",{"className":"mb-4 text-lg leading-relaxed","children":["$","img","img-0",{"src":"/img/posts/2023-3-19/2023-3-19-16.png","alt":"","className":"w-full h-auto my-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]","node":{"type":"element","tagName":"img","properties":{"src":"/img/posts/2023-3-19/2023-3-19-16.png","alt":""},"children":[],"position":{"start":{"line":248,"column":1,"offset":5416},"end":{"line":248,"column":43,"offset":5458}}}}]}]
53:["$","h2","h2-7",{"className":"text-2xl font-bold mt-6 mb-3 border-l-4 border-yellow-400 pl-4","children":"7. 总结"}]
54:["$","p","p-51",{"className":"mb-4 text-lg leading-relaxed","children":"前端灰度系统，其实就是一个后台管理系统。他配置和管理了不同版本的前端部署资源和对应的用户策略，在需要的时候进行配置。"}]
55:["$","p","p-52",{"className":"mb-4 text-lg leading-relaxed","children":["接下来的文章我会配套性的讲一下 ",["$","code","code-0",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Nginx","position":{"start":{"line":254,"column":17,"offset":5546},"end":{"line":254,"column":24,"offset":5553}}}],"position":{"start":{"line":254,"column":17,"offset":5546},"end":{"line":254,"column":24,"offset":5553}}},"children":"Nginx"}]," 和 ",["$","code","code-1",{"className":"bg-gray-100 px-1 py-0.5 rounded border border-black text-sm font-mono","node":{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Docker","position":{"start":{"line":254,"column":27,"offset":5556},"end":{"line":254,"column":35,"offset":5564}}}],"position":{"start":{"line":254,"column":27,"offset":5556},"end":{"line":254,"column":35,"offset":5564}}},"children":"Docker"}]," 的前端入门使用，敬请期待！"]}]
56:["$","p","p-53",{"className":"mb-4 text-lg leading-relaxed","children":"完！大家对灰度系统有什么好的建议，可以在评论区讨论哦！"}]
57:["$","hr","hr-2",{}]
58:["$","$Lf4",null,{"children":["$","$f5",null,{"name":"Next.MetadataOutlet","children":"$@f6"}]}]
59:["$","span","code-segment-26",{"style":{},"children":[" 1.页面访问，请求当前登录用户对应的资源版本\n"]}]
5a:["$","span","line-number--6",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[6]}]
5b:["$","span","code-segment-28",{"style":{},"children":["灰度系统"]}]
5c:["$","span","code-segment-29",{"className":"token arrow","style":{"color":"hsl(221, 87%, 60%)"},"children":["-->>"]}]
5d:["$","span","code-segment-30",{"style":{},"children":["前端项目"]}]
5e:["$","span","code-segment-31",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
5f:["$","span","code-segment-32",{"style":{},"children":[" 2.从对应版本的资源目录返回前端资源"]}]
60:["$","span","line-number--2",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[2]}]
61:["$","span","line-number--3",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[3]}]
62:["$","span","code-segment-33",{"style":{},"children":[""]}]
63:["$","span","code-segment-34",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":["axios"]}]
64:["$","span","code-segment-35",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["("]}]
65:["$","span","code-segment-36",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}]
66:["$","span","code-segment-37",{"style":{},"children":["\n"]}]
67:["$","span","line-number--4",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[4]}]
68:["$","span","code-segment-39",{"style":{},"children":["    "]}]
69:["$","span","code-segment-40",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["url"]}]
6a:["$","span","code-segment-41",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
6b:["$","span","code-segment-42",{"style":{},"children":[" "]}]
6c:["$","span","code-segment-43",{"className":"token","style":{"color":"hsl(35, 99%, 36%)"},"children":["URL"]}]
6d:["$","span","code-segment-44",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
6e:["$","span","code-segment-45",{"style":{},"children":["\n"]}]
6f:["$","span","line-number--5",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[5]}]
70:["$","span","code-segment-47",{"style":{},"children":["    "]}]
71:["$","span","code-segment-48",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["method"]}]
72:["$","span","code-segment-49",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
73:["$","span","code-segment-50",{"style":{},"children":[" "]}]
74:["$","span","code-segment-51",{"className":"token","style":{"color":"hsl(119, 34%, 47%)"},"children":["\"POST\""]}]
75:["$","span","code-segment-52",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
76:["$","span","code-segment-53",{"style":{},"children":["\n"]}]
77:["$","span","line-number--6",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[6]}]
78:["$","span","code-segment-55",{"style":{},"children":["    "]}]
79:["$","span","code-segment-56",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["headers"]}]
7a:["$","span","code-segment-57",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
7b:["$","span","code-segment-58",{"style":{},"children":[" "]}]
7c:["$","span","code-segment-59",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}]
7d:["$","span","code-segment-60",{"style":{},"children":["\n"]}]
7e:["$","span","line-number--7",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[7]}]
7f:["$","span","code-segment-62",{"style":{},"children":["        "]}]
80:["$","span","code-segment-63",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["remoteUser"]}]
81:["$","span","code-segment-64",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
82:["$","span","code-segment-65",{"style":{},"children":[" user\n"]}]
83:["$","span","line-number--8",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[8]}]
84:["$","span","code-segment-67",{"style":{},"children":["    "]}]
85:["$","span","code-segment-68",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}]
86:["$","span","code-segment-69",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
87:["$","span","code-segment-70",{"style":{},"children":["\n"]}]
88:["$","span","line-number--9",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[9]}]
89:["$","span","code-segment-72",{"style":{},"children":["    "]}]
8a:["$","span","code-segment-73",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["data"]}]
8b:["$","span","code-segment-74",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
8c:["$","span","code-segment-75",{"style":{},"children":[" "]}]
8d:["$","span","code-segment-76",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}]
8e:["$","span","code-segment-77",{"style":{},"children":["\n"]}]
8f:["$","span","line-number--10",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[10]}]
90:["$","span","code-segment-79",{"style":{},"children":["        "]}]
91:["$","span","code-segment-80",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["Action"]}]
92:["$","span","code-segment-81",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
93:["$","span","code-segment-82",{"style":{},"children":[" "]}]
94:["$","span","code-segment-83",{"className":"token","style":{"color":"hsl(119, 34%, 47%)"},"children":["\"CreateResource\""]}]
95:["$","span","code-segment-84",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
96:["$","span","code-segment-85",{"style":{},"children":["\n"]}]
97:["$","span","line-number--11",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[11]}]
98:["$","span","code-segment-87",{"style":{},"children":["        projectId"]}]
99:["$","span","code-segment-88",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
9a:["$","span","code-segment-89",{"style":{},"children":["\n"]}]
9b:["$","span","line-number--12",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[12]}]
9c:["$","span","code-segment-91",{"style":{},"children":["        branch"]}]
9d:["$","span","code-segment-92",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
9e:["$","span","code-segment-93",{"style":{},"children":["\n"]}]
9f:["$","span","line-number--13",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[13]}]
a0:["$","span","code-segment-95",{"style":{},"children":["        commitMsg"]}]
a1:["$","span","code-segment-96",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
a2:["$","span","code-segment-97",{"style":{},"children":["\n"]}]
a3:["$","span","line-number--14",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[14]}]
a4:["$","span","code-segment-99",{"style":{},"children":["        gitProjectId"]}]
a5:["$","span","code-segment-100",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
a6:["$","span","code-segment-101",{"style":{},"children":["\n"]}]
a7:["$","span","line-number--15",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[15]}]
a8:["$","span","code-segment-103",{"style":{},"children":["        "]}]
a9:["$","span","code-segment-104",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["channel"]}]
aa:["$","span","code-segment-105",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
ab:["$","span","code-segment-106",{"style":{},"children":[" "]}]
ac:["$","span","code-segment-107",{"className":"token maybe-class-name","style":{},"children":["Channel"]}]
ad:["$","span","code-segment-108",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
ae:["$","span","code-segment-109",{"style":{},"children":["\n"]}]
af:["$","span","line-number--16",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[16]}]
b0:["$","span","code-segment-111",{"style":{},"children":["        "]}]
b1:["$","span","code-segment-112",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["data"]}]
b2:["$","span","code-segment-113",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
b3:["$","span","code-segment-114",{"style":{},"children":[" fs"]}]
b4:["$","span","code-segment-115",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["."]}]
b5:["$","span","code-segment-116",{"className":"token method property-access","style":{"color":"hsl(221, 87%, 60%)"},"children":["readFileSync"]}]
b6:["$","span","code-segment-117",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["("]}]
b7:["$","span","code-segment-118",{"style":{},"children":["file"]}]
b8:["$","span","code-segment-119",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
b9:["$","span","code-segment-120",{"style":{},"children":[" "]}]
ba:["$","span","code-segment-121",{"className":"token","style":{"color":"hsl(119, 34%, 47%)"},"children":["'utf8'"]}]
bb:["$","span","code-segment-122",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[")"]}]
bc:["$","span","code-segment-123",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[","]}]
bd:["$","span","code-segment-124",{"style":{},"children":["\n"]}]
be:["$","span","line-number--17",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[17]}]
bf:["$","span","code-segment-126",{"style":{},"children":["        "]}]
c0:["$","span","code-segment-127",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["status"]}]
c1:["$","span","code-segment-128",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
c2:["$","span","code-segment-129",{"style":{},"children":[" "]}]
c3:["$","span","code-segment-130",{"className":"token","style":{"color":"hsl(119, 34%, 47%)"},"children":["\"0\""]}]
c4:["$","span","code-segment-131",{"style":{},"children":["\n"]}]
c5:["$","span","line-number--18",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[18]}]
c6:["$","span","code-segment-133",{"style":{},"children":["    "]}]
c7:["$","span","code-segment-134",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}]
c8:["$","span","code-segment-135",{"style":{},"children":["\n"]}]
c9:["$","span","line-number--19",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"2.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[19]}]
ca:["$","span","code-segment-137",{"style":{},"children":[""]}]
cb:["$","span","code-segment-138",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}]
cc:["$","span","code-segment-139",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[")"]}]
cd:["$","span","code-segment-140",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["."]}]
ce:["$","span","code-segment-141",{"className":"token method property-access","style":{"color":"hsl(221, 87%, 60%)"},"children":["then"]}]
cf:["$","span","code-segment-142",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["("]}]
d0:["$","span","code-segment-143",{"className":"token spread","style":{"color":"hsl(221, 87%, 60%)"},"children":["..."]}]
d1:["$","span","code-segment-144",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[")"]}]
d2:["$","span","code-segment-28",{"style":{},"children":[" "]}]
d3:["$","span","code-segment-29",{"className":"token","style":{"color":"hsl(35, 99%, 36%)"},"children":["ResourceVersion"]}]
d4:["$","span","code-segment-30",{"style":{},"children":[" "]}]
d5:["$","span","code-segment-31",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["{"]}]
d6:["$","span","code-segment-32",{"style":{},"children":["\n"]}]
d7:["$","span","line-number--6",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[6]}]
d8:["$","span","code-segment-34",{"style":{},"children":["    "]}]
d9:["$","span","code-segment-35",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["files"]}]
da:["$","span","code-segment-36",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
db:["$","span","code-segment-37",{"style":{},"children":[" string"]}]
dc:["$","span","code-segment-38",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["["]}]
dd:["$","span","code-segment-39",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["]"]}]
de:["$","span","code-segment-40",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[";"]}]
df:["$","span","code-segment-41",{"style":{},"children":["\n"]}]
e0:["$","span","line-number--7",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[7]}]
e1:["$","span","code-segment-43",{"style":{},"children":["    "]}]
e2:["$","span","code-segment-44",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["config"]}]
e3:["$","span","code-segment-45",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
e4:["$","span","code-segment-46",{"style":{},"children":[" "]}]
e5:["$","span","code-segment-47",{"className":"token maybe-class-name","style":{},"children":["ResourceConfig"]}]
e6:["$","span","code-segment-48",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[";"]}]
e7:["$","span","code-segment-49",{"style":{},"children":["\n"]}]
e8:["$","span","line-number--8",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[8]}]
e9:["$","span","code-segment-51",{"style":{},"children":["    "]}]
ea:["$","span","code-segment-52",{"className":"token literal-property","style":{"color":"hsl(5, 74%, 59%)"},"children":["dependencies"]}]
eb:["$","span","code-segment-53",{"className":"token","style":{"color":"hsl(221, 87%, 60%)"},"children":[":"]}]
ec:["$","span","code-segment-54",{"style":{},"children":[" string"]}]
ed:["$","span","code-segment-55",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["["]}]
ee:["$","span","code-segment-56",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["]"]}]
ef:["$","span","code-segment-57",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":[";"]}]
f0:["$","span","code-segment-58",{"style":{},"children":["\n"]}]
f1:["$","span","line-number--9",{"className":"linenumber react-syntax-highlighter-line-number","style":{"display":"inline-block","minWidth":"1.25em","paddingRight":"1em","textAlign":"right","userSelect":"none","color":"hsl(230, 4%, 64%)","fontStyle":"italic"},"children":[9]}]
f2:["$","span","code-segment-60",{"style":{},"children":[""]}]
f3:["$","span","code-segment-61",{"className":"token","style":{"color":"hsl(230, 8%, 24%)"},"children":["}"]}]
f6:null
